/******************************************************************************
 * Icinga 2                                                                   *
 * Copyright (C) 2012-2014 Icinga Development Team (http://www.icinga.org)    *
 *                                                                            *
 * This program is free software; you can redistribute it and/or              *
 * modify it under the terms of the GNU General Public License                *
 * as published by the Free Software Foundation; either version 2             *
 * of the License, or (at your option) any later version.                     *
 *                                                                            *
 * This program is distributed in the hope that it will be useful,            *
 * but WITHOUT ANY WARRANTY; without even the implied warranty of             *
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the              *
 * GNU General Public License for more details.                               *
 *                                                                            *
 * You should have received a copy of the GNU General Public License          *
 * along with this program; if not, write to the Free Software Foundation     *
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA.             *
 ******************************************************************************/

object CheckCommand "ping4" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_ping",
		"-4",
		"-H", "$HOSTADDRESS$",
		"-w", "$wrta$,$wpl$%",
		"-c", "$crta$,$cpl$%",
		"-p", "$packets$",
		"-t", "$timeout$"
	],

	vars.wrta = 100
	vars.wpl = 5
	vars.crta = 200
	vars.cpl = 15
	vars.packets = 5
	vars.timeout = 0
}

object CheckCommand "ping6" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_ping",
		"-6",
		"-H", "$HOSTADDRESS6$",
		"-w", "$wrta$,$wpl$%",
		"-c", "$crta$,$cpl$%",
		"-p", "$packets$",
		"-t", "$timeout$"
	],

	vars.wrta = 100,
	vars.wpl = 5,

	vars.crta = 200,
	vars.cpl = 15,

	vars.packets = 5,
	vars.timeout = 0
}

object CheckCommand "hostalive" {
	import "ping4"

	vars.wrta = 3000.0,
	vars.wpl = 80,

	vars.crta = 5000.0,
	vars.cpl = 100
}

object CheckCommand "dummy" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_dummy",
		"$state$",
		"$text$"
	],

	vars.state = 0,
	vars.text = "Check was successful."
}

object CheckCommand "passive" {
	import "dummy",

	vars.state = 3,
	vars.text = "No Passive Check Result Received."
}

object CheckCommand "tcp" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_tcp",
		"-H", "$HOSTADDRESS$",
		"-p", "$port$"
	]
}

object CheckCommand "udp" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_udp",
		"-H", "$HOSTADDRESS$",
		"-p", "$port$"
	]
}

object CheckCommand "http_vhost" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_http",
		"-H", "$vhost$"
	]
}

object CheckCommand "http_ip" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_http",
		"-H", "$HOSTADDRESS$"
	]
}

object CheckCommand "https_vhost" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_http",
		"-H", "$vhost$", "-S"
	]
}

object CheckCommand "https_ip" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_http",
		"-I", "$HOSTADDRESS$", "-S"
	]
}

object CheckCommand "smtp" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_smtp",
		"-H", "$HOSTADDRESS$"
	]
}

object CheckCommand "ssmtp" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_ssmtp",
		"-H", "$HOSTADDRESS$",
		"-p", "$port$"
	],

	vars.port = 465
}

object CheckCommand "ntp_time" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_ntp_time",
		"-H", "$HOSTADDRESS$"
	]
}

object CheckCommand "ssh" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_ssh",
		"$HOSTADDRESS$"
	]
}

object CheckCommand "disk" {
	import "plugin-check-command",

	command = [
		PluginDir + "/check_disk",
		"-w", "$wfree$%",
		"-c", "$cfree$%"
	],

	vars.wfree = 20,
	vars.cfree = 10,
}

object CheckCommand "users"{
	import "plugin-check-command",

	command = [
		PluginDir + "/check_users",
		"-w", "$wgreater$",
		"-c", "$cgreater$"
	],

	vars.wgreater = 20,
	vars.cgreater = 50,
}

object CheckCommand "processes"{
	import "plugin-check-command",

	command = [
		PluginDir + "/check_procs",
		"-w", "$wgreater$",
		"-c", "$cgreater$"
	],

	vars.wgreater = 250,
	vars.cgreater = 400,
}

object CheckCommand "load"{
	import "plugin-check-command",

	command = [
		PluginDir + "/check_load",
		"-w", "$wload1$,$wload5$,$wload15$",
		"-c", "$cload1$,$cload5$,$cload15$"
	],

	vars.wload1 = 5.0,
	vars.wload5 = 4.0,
	vars.wload15 = 3.0,

	vars.cload1 = 10.0,
	vars.cload5 = 6.0,
	vars.cload15 = 4.0
}

object CheckCommand "snmp"{
	import "plugin-check-command",

	command = [
		PluginDir + "/check_snmp",
		"-H", "$HOSTADDRESS$",
		"-o", "$oid$",
		"-C", "$community$"
	],

	vars.community = "public"
}

object CheckCommand "snmp-uptime"{
	import "snmp",

	vars.oid = "1.3.6.1.2.1.1.3.0"
}

object CheckCommand "icinga"{
	import "icinga-check-command",

}

object CheckCommand "cluster"{
	import "cluster-check-command",

}

object CheckCommand "snmp-extend"{
	import "plugin-check-command",

	command = [
		IcingaSysconfDir + "/icinga2/scripts/snmp-extend.sh",
		"$HOSTADDRESS$",
		"$community$",
		"$plugin$"
	],

	vars.community = "public"
}
